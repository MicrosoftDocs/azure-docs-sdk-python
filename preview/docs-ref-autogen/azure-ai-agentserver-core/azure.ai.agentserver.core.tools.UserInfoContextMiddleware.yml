### YamlMime:PythonClass
uid: azure.ai.agentserver.core.tools.UserInfoContextMiddleware
name: UserInfoContextMiddleware
fullName: azure.ai.agentserver.core.tools.UserInfoContextMiddleware
module: azure.ai.agentserver.core.tools
summary: Middleware to set user information in a context variable for each request.
constructor:
  syntax: 'UserInfoContextMiddleware(app: Callable[[MutableMapping[str, Any], Callable[[],
    Awaitable[MutableMapping[str, Any]]], Callable[[MutableMapping[str, Any]], Awaitable[None]]],
    Awaitable[None]], user_info_var: ContextVar[UserInfo | None], user_resolver: Callable[[Request],
    Awaitable[UserInfo | None]])'
  parameters:
  - name: app
    isRequired: true
  - name: user_info_var
    isRequired: true
  - name: user_resolver
    isRequired: true
methods:
- uid: azure.ai.agentserver.core.tools.UserInfoContextMiddleware.dispatch
  name: dispatch
  summary: Process the incoming request, setting the user info in the context variable.
  signature: 'async dispatch(request: Request, call_next)'
  parameters:
  - name: request
    description: The incoming Starlette request.
    isRequired: true
    types:
    - <xref:Request>
  - name: call_next
    description: The next middleware or endpoint to call.
    isRequired: true
    types:
    - <xref:typing.Callable>[[<xref:Request>], <xref:typing.Awaitable>[<xref:azure.ai.agentserver.core.models.Response>]]
  return:
    description: The response from the next middleware or endpoint.
    types:
    - <xref:azure.ai.agentserver.core.models.Response>
- uid: azure.ai.agentserver.core.tools.UserInfoContextMiddleware.install
  name: install
  summary: Install the middleware into a Starlette application.
  signature: 'install(app: Starlette, user_context: ContextVar[UserInfo | None] |
    None = None, user_resolver: Callable[[Request], Awaitable[UserInfo | None]] |
    None = None)'
  parameters:
  - name: app
    description: The Starlette application to install the middleware into.
    isRequired: true
    types:
    - <xref:Starlette>
  - name: user_context
    description: 'Optional context variable to use for storing user info.

      If not provided, a default context variable will be used.'
    defaultValue: None
    types:
    - <xref:typing.Optional>[<xref:ContextVar>[<xref:typing.Optional>[<xref:azure.ai.agentserver.core.tools.UserInfo>]]]
  - name: user_resolver
    description: 'Optional function to resolve user info from the request.

      If not provided, a default resolver will be used.'
    defaultValue: None
    types:
    - <xref:typing.Optional>[<xref:typing.Callable>[[<xref:Request>], <xref:typing.Awaitable>[<xref:typing.Optional>[<xref:azure.ai.agentserver.core.tools.UserInfo>]]]]
